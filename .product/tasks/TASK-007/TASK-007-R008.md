---
title: ConsolidaÃ§Ã£o de Agents e Workflows
task: TASK-007
code: R008
status: ðŸ“‹ To Do
created: 2024-02-22
updated: 2024-02-22
started: null
completed: null
---

# Requirement
Unificar e padronizar o sistema de agentes e workflows, removendo duplicaÃ§Ãµes e implementando uma estrutura clara de extensÃ£o.

# Dependencies
- R002 (ConsolidaÃ§Ã£o de providers) - Para integrar com providers dos agentes
- R003 (ReestruturaÃ§Ã£o de capabilities) - Para utilizar capabilities nos workflows

## Current State
```python
# DuplicaÃ§Ã£o de lÃ³gica entre agents/ e workflows/
# Estruturas similares:
# - agents/chains/ e workflows/actions.py
# - agents/registry.py e workflows/registry.py
# - agents/factory.py e core/factory.py
# Arquivos especÃ­ficos misturados com base:
# - agents/research.py e agents/task_assistant.py
```

## Implementation
```python
# 1. Consolidar registros e factories
core/registry/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py
  â”œâ”€â”€ agents.py
  â””â”€â”€ workflows.py

core/factory/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py
  â”œâ”€â”€ agents.py
  â””â”€â”€ workflows.py

# 2. Reorganizar agents por tipo
agents/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py
  â”œâ”€â”€ types.py
  â”œâ”€â”€ errors.py
  â”œâ”€â”€ registry.py      # Interface para core/registry
  â”œâ”€â”€ factory.py       # Interface para core/factory
  â”œâ”€â”€ core/           # Agentes base
  â”‚   â”œâ”€â”€ __init__.py
  â”‚   â”œâ”€â”€ task.py     # Movido de task_assistant.py
  â”‚   â””â”€â”€ research.py # Movido de research.py
  â””â”€â”€ chains/         # Unificado com workflows/actions.py
      â”œâ”€â”€ __init__.py
      â”œâ”€â”€ base.py
      â””â”€â”€ actions/

# 3. Implementar sistema unificado
class AgentRegistry:
    def __init__(self):
        self._agents = {}
        self._factory = AgentFactory()
    
    def register(self, agent_cls: Type[Agent]):
        # Registro unificado de agentes
        pass
    
    def create(self, agent_type: str) -> Agent:
        # CriaÃ§Ã£o unificada de agentes
        pass

# 4. Migrar implementaÃ§Ãµes existentes
# 5. Remover cÃ³digo antigo apÃ³s migraÃ§Ã£o
```

## Validation
```python
def test_agent_system():
    registry = AgentRegistry()
    
    # Test registration
    registry.register(TaskAgent)
    assert "task" in registry._agents
    
    # Test creation
    agent = registry.create("task")
    assert isinstance(agent, TaskAgent)
    
    # Test workflow integration
    workflow = agent.create_workflow()
    assert workflow.execute() is not None
    
    # Test chain execution
    chain = agent.create_chain()
    assert chain.run() is not None
```

## Rollback Plan
1. Backup de todos os agentes e workflows
2. Script de reversÃ£o para restaurar estrutura anterior
3. Testes de regressÃ£o para validar funcionalidade
4. DocumentaÃ§Ã£o do processo de rollback

## Success Metrics
- [ ] 100% dos agentes migrados para nova estrutura
- [ ] Zero regressÃµes em funcionalidades existentes
- [ ] ReduÃ§Ã£o de 50% no cÃ³digo duplicado
- [ ] Cobertura de testes > 95%
- [ ] DocumentaÃ§Ã£o completa do novo sistema

# Progress Updates

## 2024-02-22
- Status: ðŸ“‹ To Do
- Progress: Requirement criado e documentado 