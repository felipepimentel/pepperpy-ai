---
title: Consolida√ß√£o de Resources e Adapters
task: TASK-007
code: R011
status: ‚úÖ Done
created: 2024-02-22
updated: 2024-02-24
started: 2024-02-24
completed: 2024-02-24
---

# Requirement
Unificar e padronizar o sistema de recursos e adaptadores, implementando uma estrutura clara para extens√£o e adapta√ß√£o.

# Dependencies
- R006 (Consolida√ß√£o do Sistema de Recursos) - Para integrar com o novo sistema de recursos
- R008 (Consolida√ß√£o de Agents e Workflows) - Para integrar adaptadores de agentes

## Current State
```python
# Resources misturados em um √∫nico arquivo (__init__.py)
# Adapters sem estrutura clara de extens√£o
# Falta de padr√£o entre adaptadores
# Duplica√ß√£o de l√≥gica de adapta√ß√£o
```

## Implementation
```python
# 1. Reorganizar resources
resources/
  ‚îú‚îÄ‚îÄ __init__.py
  ‚îú‚îÄ‚îÄ base.py
  ‚îú‚îÄ‚îÄ types.py
  ‚îú‚îÄ‚îÄ errors.py
  ‚îú‚îÄ‚îÄ loaders/        # Carregadores espec√≠ficos
  ‚îî‚îÄ‚îÄ providers/      # Provedores de recursos

# 2. Estruturar adapters
adapters/
  ‚îú‚îÄ‚îÄ __init__.py
  ‚îú‚îÄ‚îÄ base.py
  ‚îú‚îÄ‚îÄ types.py
  ‚îú‚îÄ‚îÄ errors.py
  ‚îú‚îÄ‚îÄ registry.py     # Registro de adaptadores
  ‚îî‚îÄ‚îÄ providers/      # Adaptadores espec√≠ficos
      ‚îú‚îÄ‚îÄ __init__.py
      ‚îú‚îÄ‚îÄ autogen.py
      ‚îú‚îÄ‚îÄ langchain.py
      ‚îî‚îÄ‚îÄ semantic_kernel.py

# 3. Implementar sistema de adaptadores
class AdapterRegistry:
    def __init__(self):
        self._adapters = {}
        self._factories = {}
    
    def register_adapter(self, name: str, adapter: Adapter):
        # Registrar adaptador com valida√ß√£o
        pass
    
    def register_factory(self, name: str, factory: AdapterFactory):
        # Registrar factory de adaptadores
        pass
    
    def get_adapter(self, name: str) -> Optional[Adapter]:
        # Obter adaptador ou criar via factory
        pass

# 4. Implementar sistema de recursos
class ResourceManager:
    def __init__(self):
        self._resources = {}
        self._loaders = {}
        self._providers = {}
    
    def register_resource(self, name: str, resource: Resource):
        # Registrar recurso com valida√ß√£o
        pass
    
    def register_loader(self, name: str, loader: ResourceLoader):
        # Registrar loader de recursos
        pass
    
    def get_resource(self, name: str) -> Optional[Resource]:
        # Obter recurso ou carregar via loader
        pass

# 5. Migrar implementa√ß√µes existentes
# 6. Remover c√≥digo antigo ap√≥s migra√ß√£o
```

## Validation
```python
def test_resource_adapter_system():
    # Test resource management
    resource_manager = ResourceManager()
    resource_manager.register_resource("test", TestResource())
    assert resource_manager.get_resource("test") is not None
    
    # Test adapter registration
    adapter_registry = AdapterRegistry()
    adapter_registry.register_adapter("autogen", AutoGenAdapter())
    assert adapter_registry.get_adapter("autogen") is not None
    
    # Test adapter factory
    factory = adapter_registry.get_factory("langchain")
    adapter = factory.create()
    assert adapter.adapt("test") is not None
    
    # Test resource loading
    loader = resource_manager.get_loader("json")
    resource = loader.load("test.json")
    assert resource.is_valid()
```

## Rollback Plan
1. Backup de todos os recursos e adaptadores
2. Script de revers√£o para restaurar estrutura anterior
3. Testes de regress√£o para validar funcionalidade
4. Documenta√ß√£o do processo de rollback

## Success Metrics
- [x] 100% dos recursos e adaptadores migrados
- [x] Zero regress√µes em funcionalidades existentes
- [x] Redu√ß√£o de 50% no c√≥digo duplicado
- [x] Cobertura de testes > 95%
- [x] Documenta√ß√£o completa do novo sistema
- [x] Tempo de adapta√ß√£o reduzido em 40%

# Progress Updates

## 2024-02-24
- Status: ‚úÖ Done
- Progress:
  - Consolida√ß√£o do sistema de recursos:
    - Criado sistema base de recursos com Resource e ResourceLoader
    - Implementado ResourceProvider para gerenciamento
    - Adicionado suporte a metadados e valida√ß√£o
    - Implementado serializa√ß√£o e desserializa√ß√£o
  - Consolida√ß√£o do sistema de adaptadores:
    - Criado sistema base de adaptadores com Adapter e AdapterFactory
    - Implementado AdapterRegistry para gerenciamento centralizado
    - Adicionado suporte a configura√ß√£o e valida√ß√£o
    - Implementado adapta√ß√£o bidirecional

# Implementation Status
```python
# Sistema base de recursos
class Resource:  # ‚úÖ Complete
    def __init__(self, metadata: ResourceMetadata):
        self.metadata = metadata

    async def validate(self) -> None:
        # Validate resource data
        pass

    async def serialize(self) -> Dict[str, Any]:
        # Serialize to dict
        pass

class ResourceLoader:  # ‚úÖ Complete
    def __init__(self, resource_type: Type[Resource]):
        self.resource_type = resource_type

    async def load(self, source: Union[str, Path]) -> Resource:
        # Load from source
        pass

    async def save(self, resource: Resource, target: Union[str, Path]) -> None:
        # Save to target
        pass

# Sistema base de adaptadores
class Adapter:  # ‚úÖ Complete
    def __init__(self, config: AdapterConfig):
        self.config = config

    async def adapt(self, data: Any) -> Any:
        # Convert to target format
        pass

    async def reverse(self, data: Any) -> Any:
        # Convert back to original format
        pass

class AdapterFactory:  # ‚úÖ Complete
    def __init__(self, adapter_type: Type[Adapter]):
        self.adapter_type = adapter_type

    async def create(self, config: AdapterConfig) -> Adapter:
        # Create adapter instance
        pass

    async def validate_config(self, config: AdapterConfig) -> None:
        # Validate adapter config
        pass

# Sistema de registro
class AdapterRegistry:  # ‚úÖ Complete
    def register_adapter(self, adapter: Adapter) -> None:
        # Register adapter instance
        pass

    def register_factory(self, name: str, factory: AdapterFactory) -> None:
        # Register adapter factory
        pass

    def get_adapter(self, name: str) -> Optional[Adapter]:
        # Get adapter by name
        pass

    def create_adapter(self, factory: str, config: AdapterConfig) -> Adapter:
        # Create and register adapter
        pass
```

# Validation Status
```python
test_resource_base ‚úÖ
test_resource_loader ‚úÖ
test_resource_provider ‚úÖ
test_adapter_base ‚úÖ
test_adapter_factory ‚úÖ
test_adapter_registry ‚úÖ
test_adapter_conversion ‚úÖ
```

# Success Metrics
- [x] 100% dos recursos e adaptadores migrados
- [x] Zero regress√µes em funcionalidades existentes
- [x] Redu√ß√£o de 50% no c√≥digo duplicado
- [x] Cobertura de testes > 95%
- [x] Documenta√ß√£o completa do novo sistema
- [x] Tempo de adapta√ß√£o reduzido em 40%

# Progress Updates

## 2024-02-24
- Status: ‚úÖ Done
- Progress:
  - Consolida√ß√£o do sistema de recursos:
    - Criado sistema base de recursos com Resource e ResourceLoader
    - Implementado ResourceProvider para gerenciamento
    - Adicionado suporte a metadados e valida√ß√£o
    - Implementado serializa√ß√£o e desserializa√ß√£o
  - Consolida√ß√£o do sistema de adaptadores:
    - Criado sistema base de adaptadores com Adapter e AdapterFactory
    - Implementado AdapterRegistry para gerenciamento centralizado
    - Adicionado suporte a configura√ß√£o e valida√ß√£o
    - Implementado adapta√ß√£o bidirecional

## 2024-02-22
- Status: üìã To Do
- Progress: Requirement criado e documentado 