---
title: ConsolidaÃ§Ã£o de CLI e Commands
task: TASK-007
code: R010
status: ðŸ“‹ To Do
created: 2024-02-22
updated: 2024-02-22
started: null
completed: null
---

# Requirement
Unificar e padronizar o sistema de CLI e comandos, removendo duplicaÃ§Ãµes e implementando uma estrutura clara para gerenciamento de comandos.

# Dependencies
- R002 (ConsolidaÃ§Ã£o de providers) - Para integrar comandos dos providers
- R008 (ConsolidaÃ§Ã£o de Agents e Workflows) - Para integrar comandos de agentes e workflows

## Current State
```python
# Comandos dispersos em arquivos individuais:
# - agent_commands.py
# - config_commands.py
# - hub_commands.py
# - registry_commands.py
# - tool_commands.py
# - workflow_commands.py
# DuplicaÃ§Ã£o de lÃ³gica entre comandos
# UtilitÃ¡rios duplicados (cli/utils.py e core/utils.py)
```

## Implementation
```python
# 1. Consolidar comandos por domÃ­nio
cli/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py         # Classes base e decoradores
  â”œâ”€â”€ types.py        # Tipos e interfaces
  â”œâ”€â”€ errors.py       # Renomeado de exceptions.py
  â”œâ”€â”€ completion.py
  â”œâ”€â”€ main.py
  â””â”€â”€ commands/       # Comandos organizados por domÃ­nio
      â”œâ”€â”€ __init__.py
      â”œâ”€â”€ agents/     # Comandos relacionados a agentes
      â”œâ”€â”€ config/     # Comandos de configuraÃ§Ã£o
      â”œâ”€â”€ hub/        # Comandos do hub
      â”œâ”€â”€ registry/   # Comandos de registro
      â”œâ”€â”€ tools/      # Comandos de ferramentas
      â””â”€â”€ workflows/  # Comandos de workflows

# 2. Implementar sistema unificado de comandos
class CommandRegistry:
    def __init__(self):
        self._commands = {}
        self._groups = {}
    
    def register_command(self, name: str, command: Command):
        # Registrar comando com validaÃ§Ã£o
        pass
    
    def register_group(self, name: str, group: CommandGroup):
        # Registrar grupo de comandos
        pass
    
    def get_command(self, name: str) -> Optional[Command]:
        # Obter comando com fallback para grupos
        pass

# 3. Mover utilitÃ¡rios para core
core/utils/cli.py

# 4. Migrar comandos existentes
# 5. Remover arquivos antigos apÃ³s migraÃ§Ã£o
```

## Validation
```python
def test_cli_system():
    registry = CommandRegistry()
    
    # Test command registration
    registry.register_command("test", TestCommand())
    assert registry.get_command("test") is not None
    
    # Test group registration
    registry.register_group("agents", AgentCommands())
    assert registry.get_command("agents test") is not None
    
    # Test command execution
    result = registry.get_command("test").execute()
    assert result.success is True
    
    # Test completion
    completions = registry.get_completions("test")
    assert len(completions) > 0
```

## Rollback Plan
1. Backup de todos os comandos e utilitÃ¡rios
2. Script de reversÃ£o para restaurar estrutura anterior
3. Testes de regressÃ£o para validar funcionalidade
4. DocumentaÃ§Ã£o do processo de rollback

## Success Metrics
- [ ] 100% dos comandos migrados para nova estrutura
- [ ] Zero regressÃµes em funcionalidades existentes
- [ ] ReduÃ§Ã£o de 40% no cÃ³digo duplicado
- [ ] Cobertura de testes > 95%
- [ ] DocumentaÃ§Ã£o completa do novo sistema
- [ ] Tempo de resposta dos comandos reduzido em 30%

# Progress Updates

## 2024-02-22
- Status: ðŸ“‹ To Do
- Progress: Requirement criado e documentado 