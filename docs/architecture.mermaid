graph TB
    %% Core Module (Unified Core + Common)
    Core[Core]
    subgraph Core Components
        Core --> CoreUtils[Core Utils]
        Core --> CoreConfig[Core Config]
        Core --> CoreContext[Core Context]
        Core --> CoreLifecycle[Core Lifecycle]
    end

    %% Base Infrastructure
    Validation[Validation]
    Security[Security]
    Monitoring[Monitoring]
    Core --> Validation
    Core --> Security
    Core --> Monitoring

    %% Extension System
    Extensions[Extensions]
    Core --> Extensions
    Extensions --> Monitoring

    %% Middleware Layer
    Middleware[Middleware]
    Core --> Middleware
    Middleware --> Monitoring

    %% Provider System
    Providers[Providers]
    Core --> Providers
    Providers --> Monitoring

    %% Capability System
    Capabilities[Capabilities]
    Core --> Capabilities
    Capabilities --> Providers
    Capabilities --> Extensions

    %% Memory System
    Memory[Memory]
    Core --> Memory
    Memory --> Providers
    Memory --> Monitoring

    %% Reasoning System
    Reasoning[Reasoning]
    Core --> Reasoning
    Reasoning --> Providers
    Reasoning --> Memory
    Reasoning --> Monitoring

    %% Learning System
    Learning[Learning]
    Core --> Learning
    Learning --> Reasoning
    Learning --> Memory
    Learning --> Providers
    Learning --> Monitoring

    %% Strategy Management
    Strategies[Strategies]
    Core --> Strategies
    Strategies --> Learning
    Strategies --> Reasoning
    Strategies --> Providers
    Strategies --> Monitoring

    %% Composition System
    Composition[Composition]
    Core --> Composition
    Composition --> Capabilities
    Composition --> Providers
    Composition --> Strategies

    %% Orchestration Layer
    Orchestrator[Orchestrator]
    Core --> Orchestrator
    Orchestrator --> Composition
    Orchestrator --> Middleware
    Orchestrator --> Monitoring

    %% Agent System
    Agents[Agents]
    Core --> Agents
    Agents --> Orchestrator
    Agents --> Capabilities
    Agents --> Monitoring

    %% External Interfaces
    Interfaces[Interfaces]
    Core --> Interfaces
    Interfaces --> Agents
    Interfaces --> Security
    Interfaces --> Monitoring

    %% Persistence Layer
    Persistence[Persistence]
    Core --> Persistence
    Persistence --> Providers
    Persistence --> Monitoring

    %% Styling
    classDef core fill:#f9f,stroke:#333,stroke-width:2px
    classDef coreComponent fill:#f9f,stroke:#333,stroke-width:1px
    classDef infrastructure fill:#bbf,stroke:#333,stroke-width:1px
    classDef business fill:#bfb,stroke:#333,stroke-width:1px
    classDef interface fill:#fbb,stroke:#333,stroke-width:1px

    class Core core
    class CoreUtils,CoreConfig,CoreContext,CoreLifecycle coreComponent
    class Validation,Security,Monitoring,Extensions,Middleware,Providers,Persistence infrastructure
    class Capabilities,Memory,Reasoning,Learning,Strategies,Composition,Orchestrator,Agents business
    class Interfaces interface

    %% Subgraph for logical grouping
    subgraph Infrastructure
        Core
        Validation
        Security
        Monitoring
        Extensions
        Middleware
        Providers
        Persistence
    end

    subgraph Business
        Capabilities
        Memory
        Reasoning
        Learning
        Strategies
        Composition
        Orchestrator
        Agents
    end

    subgraph External
        Interfaces
    end
