---
description: ALWAYS use when creating, moving, or organizing files to ensure consistent structure and naming. This rule enforces file management standards including headers, directory structure, and naming conventions.
globs: ["**/*"]
version: 1.0
priority: high
tags: ["file-management", "structure", "organization", "standards"]
---

<?xml version="1.0" encoding="UTF-8"?>
<rule>
  <metadata>
    <n>file_management</n>
    <description>ALWAYS use when creating, moving, or organizing files to ensure consistent structure and naming. This rule enforces file management standards including headers, directory structure, and naming conventions.</description>
    <priority>high</priority>
    <version>1.0</version>
    <tags>
      <tag>file-management</tag>
      <tag>structure</tag>
      <tag>organization</tag>
      <tag>standards</tag>
    </tags>
  </metadata>

  <filters>
    <filter>
      <type>file_operation</type>
      <pattern>(create|move|rename)</pattern>
      <description>Trigger on file operations</description>
    </filter>
  </filters>

  <actions>
    <action>
      <type>validate</type>
      <conditions>
        <condition>
          <pattern>^[a-z][a-z0-9_]*\.py$</pattern>
          <message>Python files must use snake_case naming</message>
        </condition>
        <condition>
          <pattern>^__init__\.py$</pattern>
          <message>Directory must contain __init__.py with purpose documentation</message>
        </condition>
      </conditions>
    </action>
    <action>
      <type>suggest</type>
      <guidelines>
        <file_header>
          <template>
            <![CDATA[
"""
@file: {filename}
@purpose: Brief description of the file's purpose
@component: Which component this file belongs to
@created: YYYY-MM-DD
@task: TASK-XXX (if applicable)
@status: [active|deprecated|experimental]
"""
            ]]>
          </template>
        </file_header>
        
        <directory_structure>
          <rules>
            <rule>Only create directories when needed by a task</rule>
            <rule>Each directory must contain a __init__.py with its purpose</rule>
            <rule>Keep directory depth <= 3 levels when possible</rule>
            <rule>Use meaningful directory names that reflect component purpose</rule>
          </rules>
        </directory_structure>

        <naming_conventions>
          <python>
            <pattern>^[a-z][a-z0-9_]*\.py$</pattern>
            <prefixes>
              <prefix>test_</prefix>
              <prefix>i_</prefix>
              <prefix>abc_</prefix>
            </prefixes>
            <suffixes>
              <suffix>_types</suffix>
            </suffixes>
          </python>
        </naming_conventions>

        <validation_scripts>
          <script>
            <path>scripts/export_structure.py</path>
            <purpose>Generates simplified structure overview</purpose>
          </script>
          <script>
            <path>scripts/validate_headers.py</path>
            <purpose>Validates file headers</purpose>
          </script>
          <script>
            <path>scripts/check_duplicates.py</path>
            <purpose>Checks for potential duplicate files</purpose>
          </script>
        </validation_scripts>
      </guidelines>
    </action>
  </actions>

  <examples>
    <example>
      <correct>
        <case type="file_header">
          <description>Proper file header</description>
          <content>
            <![CDATA[
"""
@file: user_repository.py
@purpose: Manages user data persistence and retrieval
@component: Core/Data
@created: 2024-02-13
@task: TASK-123
@status: active
"""
            ]]>
          </content>
        </case>
        <case type="directory_structure">
          <description>Valid directory structure</description>
          <content>
pepperpy/
├── core/
│   ├── __init__.py  # Core functionality
│   └── types.py
├── providers/
│   ├── __init__.py  # Provider interfaces
│   └── base.py
└── utils/
    ├── __init__.py  # Utility functions
    └── helpers.py
          </content>
        </case>
      </correct>
      <incorrect>
        <case type="file_header">
          <description>Missing or incomplete header</description>
          <content>
            <![CDATA[
"""
Just a quick description
"""
            ]]>
          </content>
          <e>File header must follow the template format</e>
        </case>
        <case type="naming">
          <description>Invalid file naming</description>
          <paths>
            <path>UserRepository.py</path>
            <path>CONSTANTS.py</path>
          </paths>
          <e>Use snake_case for Python files (user_repository.py, constants.py)</e>
        </case>
      </incorrect>
    </example>
  </examples>
</rule> 