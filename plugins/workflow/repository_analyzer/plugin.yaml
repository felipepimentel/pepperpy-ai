name: workflow/repository_analyzer
version: 0.3.0
description: Analyze code repositories and provide insights
author: PepperPy Team
license: MIT
plugin_type: workflow
category: workflow
provider_name: repository_analyzer
entry_point: simplified_adapter.SimpleRepositoryAnalyzerAdapter
alternate_entry_points:
  standalone: standalone_adapter.StandaloneAdapter
required_config_keys: []
default_config:
  repository_path: "."
  include_patterns:
    - "**/*.py"
    - "**/*.js"
    - "**/*.ts"
    - "**/*.md"
  exclude_patterns:
    - "**/node_modules/**"
    - "**/__pycache__/**"
    - "**/.git/**"
    - "**/venv/**"
    - "**/.env/**"
  max_files: 1000
config_schema:
  repository_path:
    description: Path to the repository to analyze
    required: false
    default: "."
    type: string
  include_patterns:
    description: File patterns to include in analysis
    required: false
    default:
      - "**/*.py"
      - "**/*.js"
      - "**/*.ts"
      - "**/*.md"
    type: array
    items:
      type: string
  exclude_patterns:
    description: File patterns to exclude from analysis
    required: false
    default:
      - "**/node_modules/**"
      - "**/__pycache__/**"
      - "**/.git/**"
      - "**/venv/**"
      - "**/.env/**"
    type: array
    items:
      type: string
  max_files:
    description: Maximum number of files to analyze
    required: false
    default: 1000
    type: integer
documentation: |
  # Repository Analyzer Workflow

  A workflow for analyzing code repositories and providing insights.

  ## Features

  - Repository structure analysis
  - Code quality analysis
  - Code complexity analysis
  - Git repository information
  - Standalone mode for minimal dependency usage

  ## Usage

  ```python
  from pepperpy import workflow_manager

  # Create workflow
  analyzer = workflow_manager.create_provider(
      "workflow", "repository_analyzer",
      repository_path="/path/to/repo"
  )

  # Analyze repository structure
  result = await analyzer.execute({
      "task": "analyze_structure"
  })

  # Analyze code quality
  result = await analyzer.execute({
      "task": "analyze_code_quality"
  })

  # Find large files
  result = await analyzer.execute({
      "task": "find_large_files",
      "min_size_kb": 500,
      "limit": 10
  })

  # Full repository analysis
  result = await analyzer.execute({
      "task": "analyze_repository"
  })
  ```

  ## Standalone Usage

  The repository analyzer also provides a standalone adapter that can be used with minimal dependencies:

  ```python
  from plugins.workflow.repository_analyzer.standalone_adapter import StandaloneAdapter

  # Create standalone adapter
  adapter = StandaloneAdapter(repository_path="/path/to/repo")
  await adapter.initialize()

  # Execute a task
  result = await adapter.execute({"task": "analyze_structure"})
  print(f"Found {result['total_files']} files")

  # Clean up
  await adapter.cleanup()
  ```

  ## CLI Usage

  ```bash
  python -m pepperpy.cli workflow run workflow/repository_analyzer \
      --input '{"task": "analyze_repository", "repository_path": "/path/to/repo"}'
  ```

  ## Output

  The workflow returns a dictionary containing analysis results, which vary
  depending on the task. Common fields include:

  - `status`: "success" or "error"
  - `total_files`: Number of files analyzed
  - `structure`: Repository structure information
  - `git_info`: Git repository information (if available)

  ## Structure Analysis

  The structure analysis provides:

  - File count by directory
  - File count by extension
  - Top directories by file count
  - Top file extensions
  - Directory tree structure

  ## Code Quality Analysis

  The code quality analysis provides:

  - Line counts (total, code, comments, empty)
  - Code-to-comment ratio
  - Documentation coverage
  - Basic style checks

  ## Complexity Analysis

  The complexity analysis provides:

  - Function and class counts
  - Cyclomatic complexity metrics
  - Import analysis
  - Module dependencies

  ## Finding Large Files

  The large file analysis provides:

  - List of files exceeding specified size threshold
  - File sizes in KB and MB
  - Sorted by file size (largest first)
pepperpy_compatibility: '>=0.2.0'

requirements:
  - pydantic>=2.0.0
  - jsonschema>=4.0.0
  - radon>=5.1.0 